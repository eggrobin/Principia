
// .\Release\benchmarks.exe --benchmark_repetitions=5 --benchmark_min_time=5 --benchmark_filter=HarmonicOscillator                                                                                                                 // NOLINT(whitespace/line_length)
// Benchmarking on 1 X 3310 MHz CPU
// 2015/05/01-14:30:36
// Benchmark                                                                                                           Time(ns)    CPU(ns) Iterations                                                                                              // NOLINT(whitespace/line_length)
// --------------------------------------------------------------------------------------------------------------------------------------------------                                                                                              // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Leapfrog>                                                 2580022629 2579216533          3                                 +4.15606773735669070e-07 m, +4.16264394754398830e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Leapfrog>                                                 2511412120 2501216033          3                                 +4.15606773735669070e-07 m, +4.16264394754398830e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Leapfrog>                                                 2522838728 2511616100          3                                 +4.15606773735669070e-07 m, +4.16264394754398830e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Leapfrog>                                                 2540707485 2532416233          3                                 +4.15606773735669070e-07 m, +4.16264394754398830e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Leapfrog>                                                 2556264218 2548016333          3                                 +4.15606773735669070e-07 m, +4.16264394754398830e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Leapfrog>_mean                                            2542249036 2534496247          3                                 +4.15606773735669070e-07 m, +4.16264394754398830e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Leapfrog>_stddev                                            24303586   27633664          0                                 +4.15606773735669070e-07 m, +4.16264394754398830e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&PseudoLeapfrog>                                           2572354134 2558416400          3                                 +4.15606773750305800e-07 m, +4.16261893789685730e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&PseudoLeapfrog>                                           2576388097 2568816467          3                                 +4.15606773750305800e-07 m, +4.16261893789685730e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&PseudoLeapfrog>                                           2574671960 2574016500          3                                 +4.15606773750305800e-07 m, +4.16261893789685730e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&PseudoLeapfrog>                                           2581227915 2579216533          3                                 +4.15606773750305800e-07 m, +4.16261893789685730e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&PseudoLeapfrog>                                           2572249707 2574016500          3                                 +4.15606773750305800e-07 m, +4.16261893789685730e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&PseudoLeapfrog>_mean                                      2575378363 2570896480          3                                 +4.15606773750305800e-07 m, +4.16261893789685730e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&PseudoLeapfrog>_stddev                                       3306668    7053668          0                                 +4.15606773750305800e-07 m, +4.16261893789685730e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&McLachlanAtela1992Order2Optimal>                          2703673895 2693617267          3                                 +2.01686230361618200e-07 m, +2.02003871729904490e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&McLachlanAtela1992Order2Optimal>                          2701829569 2698817300          3                                 +2.01686230361618200e-07 m, +2.02003871729904490e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&McLachlanAtela1992Order2Optimal>                          2702361878 2704017333          3                                 +2.01686230361618200e-07 m, +2.02003871729904490e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&McLachlanAtela1992Order2Optimal>                          2737556116 2724817467          3                                 +2.01686230361618200e-07 m, +2.02003871729904490e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&McLachlanAtela1992Order2Optimal>                          2706484215 2704017333          3                                 +2.01686230361618200e-07 m, +2.02003871729904490e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&McLachlanAtela1992Order2Optimal>_mean                     2710381135 2705057340          3                                 +2.01686230361618200e-07 m, +2.02003871729904490e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&McLachlanAtela1992Order2Optimal>_stddev                     13682766   10606029          0                                 +2.01686230361618200e-07 m, +2.02003871729904490e-07 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Ruth1983>                                                 2958844002 2938018833          3                                 +7.13595849077819370e-14 m, +8.22154844204447950e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Ruth1983>                                                 2958629982 2958818967          3                                 +7.13595849077819370e-14 m, +8.22154844204447950e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Ruth1983>                                                 2960687773 2958818967          3                                 +7.13595849077819370e-14 m, +8.22154844204447950e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Ruth1983>                                                 2970034496 2943218867          3                                 +7.13595849077819370e-14 m, +8.22154844204447950e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Ruth1983>                                                 2964021341 2969219033          3                                 +7.13595849077819370e-14 m, +8.22154844204447950e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Ruth1983>_mean                                            2962443519 2953618933          3                                 +7.13595849077819370e-14 m, +8.22154844204447950e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Ruth1983>_stddev                                             4258983   11392702          0                                 +7.13595849077819370e-14 m, +8.22154844204447950e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&McLachlanAtela1992Order3Optimal>                          2962721165 2943218867          3                                 +6.86607888600310190e-14 m, +5.68867869477074350e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&McLachlanAtela1992Order3Optimal>                          2964975095 2958818967          3                                 +6.86607888600310190e-14 m, +5.68867869477074350e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&McLachlanAtela1992Order3Optimal>                          2964829898 2953618933          3                                 +6.86607888600310190e-14 m, +5.68867869477074350e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&McLachlanAtela1992Order3Optimal>                          2965985592 2958818967          3                                 +6.86607888600310190e-14 m, +5.68867869477074350e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&McLachlanAtela1992Order3Optimal>                          2960865871 2943218867          3                                 +6.86607888600310190e-14 m, +5.68867869477074350e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&McLachlanAtela1992Order3Optimal>_mean                     2963875524 2951538920          3                                 +6.86607888600310190e-14 m, +5.68867869477074350e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&McLachlanAtela1992Order3Optimal>_stddev                      1841892    7053668          0                                 +6.86607888600310190e-14 m, +5.68867869477074350e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&CandyRozmus1991ForestRuth1990SynchronousMomenta>          3087877727 3096619850          2                                 +1.64770974642181050e-13 m, +1.64847302475124020e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&CandyRozmus1991ForestRuth1990SynchronousMomenta>          3092520929 3073219700          2                                 +1.64770974642181050e-13 m, +1.64847302475124020e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&CandyRozmus1991ForestRuth1990SynchronousMomenta>          3092979527 3096619850          2                                 +1.64770974642181050e-13 m, +1.64847302475124020e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&CandyRozmus1991ForestRuth1990SynchronousMomenta>          3103235936 3096619850          2                                 +1.64770974642181050e-13 m, +1.64847302475124020e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&CandyRozmus1991ForestRuth1990SynchronousMomenta>          3106212235 3096619850          2                                 +1.64770974642181050e-13 m, +1.64847302475124020e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&CandyRozmus1991ForestRuth1990SynchronousMomenta>_mean     3096565271 3091939820          2                                 +1.64770974642181050e-13 m, +1.64847302475124020e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&CandyRozmus1991ForestRuth1990SynchronousMomenta>_stddev      6960594    9360060          0                                 +1.64770974642181050e-13 m, +1.64847302475124020e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&CandyRozmus1991ForestRuth1990SynchronousPositions>        3117293811 3096619850          2                                 +1.64717198214425760e-13 m, +1.64795260770844720e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&CandyRozmus1991ForestRuth1990SynchronousPositions>        3111876703 3104419900          2                                 +1.64717198214425760e-13 m, +1.64795260770844720e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&CandyRozmus1991ForestRuth1990SynchronousPositions>        3110509968 3120020000          2                                 +1.64717198214425760e-13 m, +1.64795260770844720e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&CandyRozmus1991ForestRuth1990SynchronousPositions>        3102807975 3104419900          2                                 +1.64717198214425760e-13 m, +1.64795260770844720e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&CandyRozmus1991ForestRuth1990SynchronousPositions>        3102756357 3096619850          2                                 +1.64717198214425760e-13 m, +1.64795260770844720e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&CandyRozmus1991ForestRuth1990SynchronousPositions>_mean   3109048963 3104419900          2                                 +1.64717198214425760e-13 m, +1.64795260770844720e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&CandyRozmus1991ForestRuth1990SynchronousPositions>_stddev    5597410    8544527          0                                 +1.64717198214425760e-13 m, +1.64795260770844720e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SRKNIntegrator,&McLachlanAtela1992Order4Optimal>                          3199377990 3166820300          2                                 +8.21200746292660710e-14 m, +8.20767065423666510e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SRKNIntegrator,&McLachlanAtela1992Order4Optimal>                          3198339916 3198020500          2                                 +8.21200746292660710e-14 m, +8.20767065423666510e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SRKNIntegrator,&McLachlanAtela1992Order4Optimal>                          3205768204 3198020500          2                                 +8.21200746292660710e-14 m, +8.20767065423666510e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SRKNIntegrator,&McLachlanAtela1992Order4Optimal>                          3202972627 3213620600          2                                 +8.21200746292660710e-14 m, +8.20767065423666510e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SRKNIntegrator,&McLachlanAtela1992Order4Optimal>                          3199149704 3198020500          2                                 +8.21200746292660710e-14 m, +8.20767065423666510e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SRKNIntegrator,&McLachlanAtela1992Order4Optimal>_mean                     3201121688 3194900480          2                                 +8.21200746292660710e-14 m, +8.20767065423666510e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SRKNIntegrator,&McLachlanAtela1992Order4Optimal>_stddev                      2817217   15284914          0                                 +8.21200746292660710e-14 m, +8.20767065423666510e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SRKNIntegrator,&McLachlanAtela1992Order5Optimal>                          3951713062 3946825300          2                                 +1.37018868473504090e-13 m, +1.37057032389975570e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SRKNIntegrator,&McLachlanAtela1992Order5Optimal>                          3956650234 3946825300          2                                 +1.37018868473504090e-13 m, +1.37057032389975570e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SRKNIntegrator,&McLachlanAtela1992Order5Optimal>                          3955360270 3939025250          2                                 +1.37018868473504090e-13 m, +1.37057032389975570e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SRKNIntegrator,&McLachlanAtela1992Order5Optimal>                          3954733229 3923425150          2                                 +1.37018868473504090e-13 m, +1.37057032389975570e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SRKNIntegrator,&McLachlanAtela1992Order5Optimal>                          3839527822 3837624600          2                                 +1.37018868473504090e-13 m, +1.37057032389975570e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SRKNIntegrator,&McLachlanAtela1992Order5Optimal>_mean                     3931596923 3918745120          2                                 +1.37018868473504090e-13 m, +1.37057032389975570e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SRKNIntegrator,&McLachlanAtela1992Order5Optimal>_stddev                     46063070   41450496          0                                 +1.37018868473504090e-13 m, +1.37057032389975570e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6A>                                       4192689276 4196426900          2                                 +2.08746214758193100e-13 m, +2.09027239961301350e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6A>                                       4184166050 4180826800          2                                 +2.08746214758193100e-13 m, +2.09027239961301350e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6A>                                       4178289628 4180826800          2                                 +2.08746214758193100e-13 m, +2.09027239961301350e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6A>                                       4179353690 4180826800          2                                 +2.08746214758193100e-13 m, +2.09027239961301350e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6A>                                       4179820276 4165226700          2                                 +2.08746214758193100e-13 m, +2.09027239961301350e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6A>_mean                                  4182863784 4180826800          2                                 +2.08746214758193100e-13 m, +2.09027239961301350e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6A>_stddev                                   5305521    9866370          0                                 +2.08746214758193100e-13 m, +2.09027239961301350e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6B>                                       4176025129 4180826800          2                                 +3.59743485001118300e-13 m, +3.60239615915247670e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6B>                                       4180904722 4180826800          2                                 +3.59743485001118300e-13 m, +3.60239615915247670e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6B>                                       4224214530 4173026750          2                                 +3.59743485001118300e-13 m, +3.60239615915247670e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6B>                                       4185758686 4180826800          2                                 +3.59743485001118300e-13 m, +3.60239615915247670e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6B>                                       4184085465 4180826800          2                                 +3.59743485001118300e-13 m, +3.60239615915247670e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6B>_mean                                  4190197706 4179266790          2                                 +3.59743485001118300e-13 m, +3.60239615915247670e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6B>_stddev                                  17328763    3120020          0                                 +3.59743485001118300e-13 m, +3.60239615915247670e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6C>                                       4184741831 4149626600          2                                 +1.66231611808953520e-13 m, +1.66453656413878550e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6C>                                       4171667552 4157426650          2                                 +1.66231611808953520e-13 m, +1.66453656413878550e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6C>                                       4186492658 4157426650          2                                 +1.66231611808953520e-13 m, +1.66453656413878550e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6C>                                       4192797041 4204226950          2                                 +1.66231611808953520e-13 m, +1.66453656413878550e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6C>                                       4169733262 4173026750          2                                 +1.66231611808953520e-13 m, +1.66453656413878550e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6C>_mean                                  4181086469 4168346720          2                                 +1.66231611808953520e-13 m, +1.66453656413878550e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order6C>_stddev                                   8914453   19484519          0                                 +1.66231611808953520e-13 m, +1.66453656413878550e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8A>                                       6267102933 6255640100          1                                 +5.11861386609524520e-13 m, +5.12544867659059380e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8A>                                       6250682807 6240040000          1                                 +5.11861386609524520e-13 m, +5.12544867659059380e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8A>                                       6267341590 6255640100          1                                 +5.11861386609524520e-13 m, +5.12544867659059380e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8A>                                       6250335431 6255640100          1                                 +5.11861386609524520e-13 m, +5.12544867659059380e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8A>                                       6259484267 6240040000          1                                 +5.11861386609524520e-13 m, +5.12544867659059380e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8A>_mean                                  6258989406 6249400060          1                                 +5.11861386609524520e-13 m, +5.12544867659059380e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8A>_stddev                                   7479626    7642457          0                                 +5.11861386609524520e-13 m, +5.12544867659059380e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8B>                                       6244759536 6224439900          1                                 +1.74530528918026560e-13 m, +1.74762981863807450e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8B>                                       6254425979 6271240200          1                                 +1.74530528918026560e-13 m, +1.74762981863807450e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8B>                                       6274319864 6240040000          1                                 +1.74530528918026560e-13 m, +1.74762981863807450e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8B>                                       6274161792 6255640100          1                                 +1.74530528918026560e-13 m, +1.74762981863807450e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8B>                                       6301272130 6286840300          1                                 +1.74530528918026560e-13 m, +1.74762981863807450e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8B>_mean                                  6269787860 6255640100          1                                 +1.74530528918026560e-13 m, +1.74762981863807450e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8B>_stddev                                  19459363   22061873          0                                 +1.74530528918026560e-13 m, +1.74762981863807450e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8C>                                       6246409154 6240040000          1                                 +4.31519403543134670e-13 m, +4.32123087312774600e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8C>                                       6291528440 6271240200          1                                 +4.31519403543134670e-13 m, +4.32123087312774600e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8C>                                       6298453069 6302440400          1                                 +4.31519403543134670e-13 m, +4.32123087312774600e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8C>                                       6250978208 6255640100          1                                 +4.31519403543134670e-13 m, +4.32123087312774600e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8C>                                       6243760324 6240040000          1                                 +4.31519403543134670e-13 m, +4.32123087312774600e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8C>_mean                                  6266225839 6261880140          1                                 +4.31519403543134670e-13 m, +4.32123087312774600e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8C>_stddev                                  23701083   23348092          0                                 +4.31519403543134670e-13 m, +4.32123087312774600e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8D>                                       6322197414 6302440400          1                                 +2.44630704582249340e-13 m, +2.44953363148781020e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8D>                                       6302983260 6286840300          1                                 +2.44630704582249340e-13 m, +2.44953363148781020e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8D>                                       6283815837 6286840300          1                                 +2.44630704582249340e-13 m, +2.44953363148781020e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8D>                                       6272645211 6208839800          1                                 +2.44630704582249340e-13 m, +2.44953363148781020e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8D>                                       6256758666 6255640100          1                                 +2.44630704582249340e-13 m, +2.44953363148781020e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8D>_mean                                  6287680078 6268120180          1                                 +2.44630704582249340e-13 m, +2.44953363148781020e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8D>_stddev                                  22903044   33312698          0                                 +2.44630704582249340e-13 m, +2.44953363148781020e-13 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8E>                                       6273462510 6286840300          1                                 +8.20819107127945810e-14 m, +8.20281342850393000e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8E>                                       6264977432 6255640100          1                                 +8.20819107127945810e-14 m, +8.20281342850393000e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8E>                                       6274010635 6286840300          1                                 +8.20819107127945810e-14 m, +8.20281342850393000e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8E>                                       6328061795 6302440400          1                                 +8.20819107127945810e-14 m, +8.20281342850393000e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8E>                                       6290992713 6286840300          1                                 +8.20819107127945810e-14 m, +8.20281342850393000e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8E>_mean                                  6286301017 6283720280          1                                 +8.20819107127945810e-14 m, +8.20281342850393000e-14 m s^-1  // NOLINT(whitespace/line_length)
// BM_SolveHarmonicOscillator<SPRKIntegrator,&Yoshida1990Order8E>_stddev                                  22523546   15284914          0                                 +8.20819107127945810e-14 m, +8.20281342850393000e-14 m s^-1  // NOLINT(whitespace/line_length)

#define GLOG_NO_ABBREVIATED_SEVERITIES

#include <stddef.h>
#include <algorithm>
#include <functional>
#include <ostream>
#include <string>
#include <vector>

#include "base/not_null.hpp"
#include "benchmark/benchmark_api.h"
#include "geometry/r3_element.hpp"
#include "integrators/motion_integrator.hpp"
#include "integrators/sprk_integrator.hpp"
#include "integrators/srkn_integrator.hpp"
#include "integrators/symplectic_runge_kutta_nyström_integrator.hpp"
#include "numerics/double_precision.hpp"
#include "physics/continuous_trajectory.hpp"
#include "physics/discrete_trajectory.hpp"
#include "physics/rotating_body.hpp"
#include "quantities/elementary_functions.hpp"
#include "quantities/named_quantities.hpp"
#include "quantities/quantities.hpp"
#include "testing_utilities/integration.hpp"

namespace principia {

using quantities::Abs;
using quantities::AngularFrequency;
using quantities::Cos;
using quantities::Length;
using quantities::SIUnit;
using testing_utilities::ComputeHarmonicOscillatorAcceleration;

namespace integrators {

void SolveHarmonicOscillatorAndComputeError(
    not_null<benchmark::State*> const state,
    not_null<Length*> const q_error,
    not_null<Speed*> const v_error,
    SRKNIntegrator const& integrator) {
  state->PauseTiming();
  SRKNIntegrator::Solution<Length, Speed> solution;
  SRKNIntegrator::Parameters<Length, Speed> parameters;

  parameters.initial.positions.emplace_back(SIUnit<Length>());
  parameters.initial.momenta.emplace_back(Speed());
  parameters.initial.time = Time();
#ifdef _DEBUG
  parameters.tmax = 100.0 * SIUnit<Time>();
#else
  parameters.tmax = 1000.0 * SIUnit<Time>();
#endif
  // NOTE(phl): This used to be 1.0E-4, but this causes us to run out of memory
  // in the new benchmarks.  Reducing to 3.0E-4 to permit comparisons.
  parameters.Δt = 3.0E-4 * SIUnit<Time>();
  parameters.sampling_period = 1;
  state->ResumeTiming();

  integrator.SolveTrivialKineticEnergyIncrement<Length>(
      &ComputeHarmonicOscillatorAcceleration,
      parameters,
      &solution);

  state->PauseTiming();
  *q_error = Length();
  *v_error = Speed();
  for (std::size_t i = 0; i < solution.size(); ++i) {
    *q_error = std::max(*q_error,
                        Abs(solution[i].positions[0].value -
                            SIUnit<Length>() *
                            Cos(solution[i].time.value *
                                SIUnit<AngularFrequency>())));
    *v_error = std::max(*v_error,
                        Abs(solution[i].momenta[0].value +
                            SIUnit<Speed>() *
                            Sin(solution[i].time.value *
                                SIUnit<AngularFrequency>())));
  }
  state->ResumeTiming();
}

template<typename Integrator, Integrator const& (*integrator)()>
void BM_SolveHarmonicOscillator(
    benchmark::State& state) {  // NOLINT(runtime/references)
  Length q_error;
  Speed v_error;
  while (state.KeepRunning()) {
    SolveHarmonicOscillatorAndComputeError(&state, &q_error, &v_error,
                                           integrator());
  }
  std::stringstream ss;
  ss << q_error << ", " << v_error;
  state.SetLabel(ss.str());
}

BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &Leapfrog);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &PseudoLeapfrog);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &McLachlanAtela1992Order2Optimal);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &Ruth1983);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &McLachlanAtela1992Order3Optimal);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &CandyRozmus1991ForestRuth1990SynchronousMomenta);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &CandyRozmus1991ForestRuth1990SynchronousPositions);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SRKNIntegrator,
                    &McLachlanAtela1992Order4Optimal);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SRKNIntegrator,
                    &McLachlanAtela1992Order5Optimal);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &Yoshida1990Order6A);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &Yoshida1990Order6B);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &Yoshida1990Order6C);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &Yoshida1990Order8A);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &Yoshida1990Order8B);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &Yoshida1990Order8C);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &Yoshida1990Order8D);
BENCHMARK_TEMPLATE2(BM_SolveHarmonicOscillator, SPRKIntegrator,
                    &Yoshida1990Order8E);

}  // namespace integrators
}  // namespace principia
